<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:data-description-th="http://www.w3.org/1999/xhtml"
      xmlns:data-description="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leave Tracking System</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/request-leave.css}">


</head>
<body>
<!-- Sidebar Menu -->
<div class="sidebar">
    <h2>Menu</h2>
    <ul>
        <li><a href="/home">Home</a></li>
        <li><a href="/requestLeaves">Request Leave</a></li>
        <li><a href="/requestLeaves">Today's Leave</a></li>
        <li><a href="/viewUsers">Manage Users</a></li>
    </ul>
</div>

<!-- Main Content -->
<div class="main-content">
    <div class="header">
        <h1>Leave Tracking System</h1>
        <div class="user-info">
            <span class="username">Welcome, <span th:text="${username}">User</span>!</span>
            <form action="/logout" method="post" class="logout-form">
                <button type="submit">Log Out</button>
            </form>
        </div>
    </div>

    <!-- Table Section -->
    <div class="table-section">
        <h2>
            Today's Leave Status
            <span style="float: right;">
                <button id="addLeaveBtn"
                        style="background-color: #008CBA; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-size: 14px;">
                    Add Leave
                </button>
            </span>
        </h2>
        <table>
            <thead>
            <tr>
                <th>ID</th>
                <th>Role</th>
                <th>Name</th>
                <th>Email</th>
                <th>Leave Start</th>
                <th>Leave End</th>
                <th>Status</th>
                <th>Description</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="leave : ${leaveRequestDtos}">
                <td th:text="${leave.id}"></td>
                <td th:text="${userRoles[leave.id]}"></td>
                <td th:text="${userNames[leave.id]}"></td>
                <td th:text="${userEmails[leave.id]}"></td>
                <td th:text="${leave.startDate}"></td>
                <td th:text="${leave.endDate}"></td>
                <td th:text="${statusValues[leave.id]}"></td>
                <!-- Buton Eklemek İçin Tablonun Güncellenmiş Hali -->
                <td class="description-cell">
                    <button class="view-description-btn" th:data-description="${leave.description}">View</button>
                </td>


                <td>
                    <button th:if="${leave.status == 1}" id="trueButton"
                            style="background-color: #4CAF50; color: white; border: none; border-radius: 50%; width: 25px; height: 25px; cursor: pointer;">
                        ✓
                    </button>
                </td>
                <td>
                    <button th:if="${leave.status == 1}" id="falseButton"
                            style="background-color: #F44336; color: white; border: none; border-radius: 50%; width: 25px; height: 25px; cursor: pointer;">
                        x
                    </button>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</div>


<!-- Açıklama Modal Yapısı -->
<div id="descriptionModal" class="modal">
    <div class="modal-content">
        <span class="close-description">&times;</span>
        <h2>Description</h2>
        <p id="descriptionText"></p>
    </div>
</div>


<!-- Modal Structure -->
<div id="leaveModal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <h2>Request Leave</h2>
        <form action="/submitLeaveRequest" method="post">

            <label for="userlist">Select User:</label>
            <select id="userlist" name="userlist" required>
                <!-- Options will be dynamically added here -->
            </select>

            <label for="startDate">Start Date:</label>
            <input type="date" id="startDate" name="startDate" required>

            <label for="endDate">End Date:</label>
            <input type="date" id="endDate" name="endDate" required>

            <label for="description">Description:</label>
            <textarea id="description" name="description" rows="4" required></textarea>

            <button type="submit">Submit Leave Request</button>
        </form>
    </div>
</div>
<script th:src="@{/js/request-leave.js}"></script>
</body>
</html>